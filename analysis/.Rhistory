gained_votes %>%
ggplot(aes(x = gained_votes, color = on_toppage)) +
geom_bar()
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = n()) %>%
ungroup()
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = sum()) %>%
ungroup()
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = sum(gained_votes)) %>%
ungroup()
newpage_moving_window
max(newpage_moving_window$rank_newpage)
newpage_moving_window %>% get_random_sample(1)
gained_votes
data_gained_votes %>%
group_by(id) %>%
mutate(next_score = lead(score)) %>%
ungroup() %>%
mutate(gained_votes = next_score - score)
newpage_moving_window %>%
select(id, score, rank_toppage, samptime_datetime) %>%
mutate(on_toppage = !(is.na(rank_toppage))) %>%
arrange(id, samptime_datetime) -> data_gained_votes
data_gained_votes %>%
group_by(id) %>%
mutate(next_score = lead(score)) %>%
ungroup() %>%
mutate(gained_votes = next_score - score) %>%
select(on_toppage, gained_votes) %>%
filter(!is.na(gained_votes)) -> gained_votes
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = sum(gained_votes)) %>%
ungroup()
data_gained_votes
newpage_moving_window %>%
select(id, score, rank_toppage, rank_newpage, samptime_datetime) %>%
mutate(on_toppage = !(is.na(rank_toppage))) %>%
arrange(id, samptime_datetime) -> data_gained_votes
data_gained_votes %>%
group_by(id) %>%
mutate(next_score = lead(score)) %>%
ungroup() %>%
mutate(gained_votes = next_score - score) %>%
select(on_toppage, gained_votes) %>%
filter(!is.na(gained_votes)) -> gained_votes
newpage_moving_window %>%
select(id, score, rank_toppage, rank_newpage, samptime_datetime) %>%
mutate(on_toppage = !(is.na(rank_toppage))) %>%
arrange(id, samptime_datetime) -> data_gained_votes
data_gained_votes %>%
group_by(id) %>%
mutate(next_score = lead(score)) %>%
ungroup() %>%
mutate(gained_votes = next_score - score) %>%
# select(on_toppage, gained_votes) %>%
filter(!is.na(gained_votes)) -> gained_votes
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = sum(gained_votes)) %>%
ungroup()
gained_votes
newpage_moving_window %>%
select(id, score, rank_toppage, rank_newpage, samptime_datetime) %>%
mutate(on_toppage = !(is.na(rank_toppage))) %>%
arrange(id, samptime_datetime) -> data_gained_votes
data_gained_votes %>%
group_by(id) %>%
mutate(next_score = lead(score)) %>%
ungroup() %>%
mutate(gained_votes = next_score - score) %>%
filter(!is.na(gained_votes)) -> gained_votes
gained_votes %>%
group_by(on_toppage) %>%
summarize(count = sum(gained_votes)) %>%
ungroup()
gained_votes
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(X = rank_newpage, y = mean_gained_votes)) +
geom_line()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(X = rank_toppage, y = mean_gained_votes)) +
geom_line()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(x = rank_toppage, y = mean_gained_votes)) +
geom_line()
gained_votes %>%
group_by(rank_newpage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(x = rank_newpage, y = mean_gained_votes)) +
geom_line()
gained_votes %>%
group_by(rank_newpage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(x = rank_newpage, y = mean_gained_votes)) +
geom_point()
gained_votes %>%
group_by(rank_newpage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(x = rank_newpage, y = mean_gained_votes)) +
geom_point(size = 0.01)
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
ggplot(aes(x = rank_toppage, y = mean_gained_votes)) +
geom_line()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup()
gained_votes %>%
group_by(rank_toppage) %>%
summarize(mean_gained_votes = mean(gained_votes)) %>%
ungroup() -> mean_gained_votes_toppage
mean_gained_votes_toppage
gained_votes
mean_gained_votes_toppage
gained_votes
gained_votes %>%
group_by(rank_toppage, gained_votes) %>%
summarize(count = n())
gained_votes
gained_votes %>%
filter(rank_toppage <= 100)
gained_votes %>%
filter(rank_toppage <= 100) %>%
ggplot(aes(x = rank_toppage)) +
geom_bar()
gained_votes %>%
filter(rank_toppage <= 100)
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
mutate(mean_gained_votes = mean(gained_votes)) %>%
ungroup()
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
mutate(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
select(rank_toppage, mean_gained_votes) %>%
arrange(rank_toppage)
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
mutate(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
select(rank_toppage, mean_gained_votes) %>%
arrange(rank_toppage) %>%
ggplot(aes(x = mean_gained_votes)) +
geom_density()
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
mutate(mean_gained_votes = mean(gained_votes)) %>%
ungroup() %>%
select(rank_toppage, mean_gained_votes) %>%
arrange(rank_toppage)
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup()
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
tmp
tmp %>% as.matrix
?as.matrix
tmp %>% as.matrix()
tmp_matrix <- tmp %>% as.matrix()
tmp_matrix
length(tmp_matrix)
tmp_matrix[1]
length(tmp_matrix[1, ])
length(tmp_matrix[, 1])
tmp_matrix[, 1]
print(i)
for (i in 1:length(tmp_matrix[, 1])) {
print(i)
}
tmp_matrix[, 2] %>%  sum()
x <- vector(mode = "numeric", length = sum(tmp_matrix[, 2]))
i <- 1
addition <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
addition
length(addition)
tmp
tmp_matrix <- as.matrix(tmp)
x <- vector(mode = "numeric", length = sum(tmp_matrix[, 2]))
curr_index <- 1
for (i in 1:length(tmp_matrix[, 1])) {
addition <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x[curr_index:curr_index + length(addition)] <- addition
curr_index <- curr_index + length(addition) + 1
}
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
tmp_matrix <- as.matrix(tmp)
x <- vector(mode = "numeric", length = sum(tmp_matrix[, 2]))
curr_index <- 1
for (i in 1:length(tmp_matrix[, 1])) {
addition <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x[curr_index:curr_index + length(addition)] <- addition
curr_index <- curr_index + length(addition)
}
curr_index <- 1
i <- 1
addition <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
length(addition)
curr_index
x[curr_index:curr_index + length(addition)] <- addition
x[curr_index:curr_index + length(addition) - 1] <- addition
x[curr_index:curr_index + length(addition) + 1] <- addition
x[curr_index:curr_index + length(addition) + 1]
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x
unname(x)
x %<>% unname()
tibble(vote_at_rank = x)
tibble(vote_at_rank = x) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar()
tibble(vote_at_rank = x) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, )
tibble(vote_at_rank = x) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
MASS::fitdistr(x, densfun = "exponential")
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
tmp
sum(tmp$gained_votes_sum)
rexp(119358, lambda_exp)
rexp(119358, rate = lambda_exp)
lambda_exp
lambda_exp$estimate
rexp(119358, rate = lambda_exp$estimate)
x_sim <- rexp(119358, rate = lambda_exp$estimate)
tibble(simulated_vote_at_rank = x_sim) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
tibble(simulated_vote_at_rank = x_sim) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_density()
gained_votes %>%
filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
sum(tmp$gained_votes_sum)
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
tibble(vote_at_rank = x) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
x_sim %>% head()
x_sim %<>% round()
x_sim %>% head()
tibble(simulated_vote_at_rank = x_sim) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100)
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
lambda_exp$estimate
x_sim <- rexp(119358, rate = lambda_exp$estimate)
x_sim %<>% round()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
gained_votes %>%
# filter(rank_toppage <= 100) %>%
ggplot(aes(x = rank_toppage)) +
geom_bar()
gained_votes %>%
# filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
sum(tmp$gained_votes_sum)
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
tibble(vote_at_rank = x) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
tibble(x = x)
tibble(x = x) %>%
filter(is.na(x))
tibble(x = x) %>%
filter(!is.na(x))
x %>%
filter(!is.na())
!(is.na(x))
!is.na(x)
x[!is.na(x)]
x <- x[!is.na(x)]
x <- x[!is.na(x)]
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
lambda_exp$estimate
x_sim <- rexp(119358, rate = lambda_exp$estimate)
x_sim %<>% round()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
gained_votes %>%
# filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
sum(tmp$gained_votes_sum)
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
x <- x - 1
x
gained_votes %>%
# filter(rank_toppage <= 100) %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
sum(tmp$gained_votes_sum)
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
# number of votes cast altogether
all_votes <- sum(tmp$gained_votes_sum)
all_votes
# fit exponential distribution
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
# compute number of votes cast at each rank
gained_votes %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
# format data for distribution fitting
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
x <- x[!is.na(x)]
# show distribution over first 100 ranks on top page
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
# fit exponential distribution
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
x_sim <- rexp(length(x), rate = lambda_exp$estimate)
x_sim %<>% round()
x_sim
# fit exponential distribution
lambda_exp <- MASS::fitdistr(x, densfun = "exponential")
x_sim <- rexp(length(x), rate = lambda_exp$estimate)
x_sim %<>% round()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
# fit geometric distribution
MASS::fitdistr(x, densfun = "geometric")
# fit geometric distribution
prob_geom <- MASS::fitdistr(x, densfun = "geometric")
# fit geometric distribution
geom_estimator <- MASS::fitdistr(x, densfun = "geometric")
# fit exponential distribution
exp_estimator <- MASS::fitdistr(x, densfun = "exponential")
x_sim <- rexp(length(x), rate = exp_estimator$estimate)
x_sim %<>% round()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
geom_estimator$
x_sim <- rexp(length(x), )
geom_estimator$estimate
x_sim <- rexp(length(x), geom_estimator$estimate)
x_sim %>% head()
# fit geometric distribution
geom_estimator <- MASS::fitdistr(x, densfun = "geometric")
x_sim <- rgeom(length(x), geom_estimator$estimate)
x_sim %>% head()
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
x_sim <- x_sim + 1
tibble(simulated_vote_at_rank = x_sim) %>%
filter(simulated_vote_at_rank <= 100) %>%
ggplot(aes(x = simulated_vote_at_rank)) +
geom_bar()
# show distribution over first 100 ranks on top page
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
filter(vote_at_rank > 1) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
filter(vote_at_rank > 2 %>%
# compute number of votes cast at each rank
gained_votes %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
# format data for distribution fitting
tmp_matrix <- as.matrix(tmp)
# show distribution over first 100 ranks on top page
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
filter(vote_at_rank > 2) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")
# compute number of votes cast at each rank
gained_votes %>%
group_by(rank_toppage) %>%
summarize(gained_votes_sum = sum(gained_votes)) %>%
ungroup() -> tmp
# format data for distribution fitting
tmp_matrix <- as.matrix(tmp)
x <- c()
for (i in 1:length(tmp_matrix[, 1])) {
values <- rep(tmp_matrix[i, 1], tmp_matrix[i, 2])
x <- c(x, values)
}
x %<>% unname()
x <- x[!is.na(x)]
# show distribution over first 100 ranks on top page
tibble(vote_at_rank = x) %>%
filter(vote_at_rank <= 100) %>%
ggplot(aes(x = vote_at_rank)) +
geom_bar() +
geom_vline(xintercept = 30, linetype = "dashed", color = "red")

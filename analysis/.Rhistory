newpage_moving_window %>%
get_random_sample(50) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.1) +
scale_y_continuous(trans = "reverse") +
# scale_y_log10() +
coord_fli
newpage_moving_window %>%
get_random_sample(50) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.1) +
scale_y_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(50) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.1) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(50) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
ggplot2::ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
ggplot2::geom_line(alpha = 0.8)
newpage_moving_window %>%
get_random_sample(50) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
data %>%
select(id, score, rank_toppage, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = lubridate::round_date(samptime_datetime, unit = "minute")) %>%
group_by(samptime_coarse) %>%
slice_max(n = 200, order_by = subtime_datetime) %>%
mutate(rank_newpage = row_number()) %>%
ungroup() %>%
arrange(samptime_coarse) %>%
mutate(on_toppage = !is.na(rank_toppage)) -> newpage_moving_window
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2) +
scale_x_continuous(trans = "reverse") +
scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2, width = 0.5) +
scale_x_continuous(trans = "reverse") +
scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2, height = 0.5) +
scale_x_continuous(trans = "reverse") +
scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2, height = 0.2) +
scale_x_continuous(trans = "reverse") +
scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
# geom_line(alpha = 0.8) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_line() +
scale_x_continuous(trans = "reverse") +
# scale_y_log10() +
coord_flip()
newpage_moving_window
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = subtime_datetime, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = subtime_datetime, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
# scale_x_continuous(trans = "reverse") +
coord_flip()
newpage_moving_window
data %>%
select(id, age_seconds, score, rank_toppage, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = lubridate::round_date(samptime_datetime, unit = "minute")) %>%
group_by(samptime_coarse) %>%
slice_max(n = 200, order_by = subtime_datetime) %>%
mutate(rank_newpage = row_number()) %>%
ungroup() %>%
arrange(samptime_coarse) %>%
mutate(on_toppage = !is.na(rank_toppage)) -> newpage_moving_window
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
# scale_x_continuous(trans = "reverse") +
coord_flip()
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
# scale_x_continuous(trans = "reverse") +
NULL
newpage_moving_window %>%
filter(age_seconds <= 50000) %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
# scale_x_continuous(trans = "reverse") +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "gold")
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "gold")
newpage_moving_window %>%
filter(age_seconds <= 50000) %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "gold4")
newpage_moving_window %>%
filter(age_seconds <= 50000) %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
filter(age_seconds <= 50000) %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
filter(age_seconds <= 50000) %>%
get_random_sample(100) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
# filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "lightgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "firebrick")
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
coord_flip()
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
coord_flip()
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "firebrick")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
filter(age_seconds <= 50000) %>%
ggplot(aes(x = age_seconds / 3600, y = score, group = id, color = on_toppage)) +
# geom_jitter(alpha = 0.2, height = 0.05) +
geom_point(alpha = 0.2) +
scale_color_manual(values = color_scheme) +
# scale_x_continuous(trans = "reverse") +
scale_y_log10() +
theme_hn() +
NULL
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip()
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn()
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.background = element_rect(fill = "grey80"))
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.background = element_rect(fill = "grey80", color = "transparent"))
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn()
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.grid = element_blank())
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.grid.x = element_blank())
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.grid.major.x = element_blank())
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
coord_flip() +
theme_hn() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank())
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.2, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
labs(title = "How do stories emerge from the new page to the top page?",
x = "Newpage Rank",
y = "Score",
color = "On Toppage") +
coord_flip() +
theme_hn() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank())
color_scheme <- c("FALSE" = "darkgrey", "TRUE" = "red")
set.seed(123)
newpage_moving_window %>%
get_random_sample(100) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_jitter(alpha = 0.1, height = 0.05) +
scale_x_continuous(trans = "reverse") +
scale_color_manual(values = color_scheme) +
labs(title = "How do stories emerge from the new page to the top page?",
x = "Newpage Rank",
y = "Score",
color = "On Toppage") +
coord_flip() +
theme_hn() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank())
data
newpage_moving_window
newpage_moving_window %>%
select(id, rank_toppage) %>%
unique()
newpage_moving_window %>%
filter(!on_toppage)
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(on_toppage)) 1:which.max(on_toppage) else row_number())
newpage_moving_window %>%
group_by(id)
filter(!on_toppage)
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(!on_toppage)) 1:which.max(!on_toppage) else row_number())
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(on_toppage == FALSE)) 1:which.max(on_toppage == FALSE) else row_number())
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(on_toppage == FALSE)) 1:which.max(on_toppage == FALSE) else row_number()) %>%
arrange(samptime_datetime)
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(on_toppage == FALSE)) 1:which.max(on_toppage == FALSE) else row_number()) %>%
group_by(id) %>%
arrange(samptime_datetime)
newpage_moving_window %>%
group_by(id) %>%
slice(if(any(on_toppage == FALSE)) 1:which.max(on_toppage == FALSE) else row_number())

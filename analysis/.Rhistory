simulated
simulated <- rpois(dim(arrival_diffs)[1], mle_arrivals$estimate)
simulated
simulated %<>% as.data.frame()
simulated
simulated <- data.frame(arrival_diff = simulated)
simulated
simulated <- rpois(dim(arrival_diffs)[1], mle_arrivals$estimate)
simulated <- data.frame(arrival_diff = simulated)
simulated
simulated %>%
ggplot(aes(x = arrival_diff)) +
geom_histogram()
arrival_diffs %>%
ggplot(aes(x = subtime_relative)) +
geom_histogram()
mle_arrivals
mle_arrivals$estimate
mle_arrivals$estimate["lambda"]
dim(arrival_diffs)[1]
rpois(3822, 105.439) %>%
as.data.frame() %>%
ggplot(aes(x = .)) +
geom_histogram()
arrival_diffs
arrival_diffs_mean <- mean(arrival_diffs$subtime_relative)
arrival_diffs_mean
mle_arrivals
arrival_diffs_mean
mean(simulated$arrival_diff)
?cut
sorted_submission_times
sorted_submission_times %>% cut(breaks = "5 minutes")
sorted_submission_times$subtime_datetime %>% cut(breaks = "5 minutes")
sorted_submission_times$subtime_datetime %>%
as.numeric() %>%
cut(breaks = "5 minutes")
sorted_submission_times$subtime_datetime %>%
as.POSIXct()
sorted_submission_times$subtime_datetime %>%
as.POSIXct() %>%
cut(breaks = "5 minutes")
?cut.POSIXct
?cut.POSIXlt
?cut.POSIXxt
?cut.POSIXt
sorted_submission_times$subtime_datetime %>%
as.POSIXt()
sorted_submission_times$subtime_datetime %>%
as.numeric()
sorted_submission_times$subtime_datetime %>%
as.numeric() %>%
cut(breaks = 300)
sorted_submission_times$subtime_datetime %>%
as.numeric() %>%
cut(breaks = 300) %>%
as.data.frame()
subtimes_unix <- sorted_submission_times$subtime_datetime %>% as.numeric()
cuts <- cut(subtimes_unix, breaks = 300, labels = FALSE)
cuts
data.frame(subtimes_unix, cuts)
data.frame(subtimes_unix, cuts) %>%
group_by(cuts) %>%
summarize(count = n())
299 * 300
(299 * 300) / 60
(299 * 300) / 60 / 60
max(sorted_submission_times$subtime_datetime) - min(sorted_submission_times$subtime_datetime)
data.frame(subtimes_unix, cuts) %>%
group_by(cuts) %>%
summarize(count = n())
data.frame(subtimes_unix, cuts) %>%
group_by(cuts) %>%
summarize(count = n()) -> tmp
tmp$id
tmp
tmp$cuts max()
tmp$cuts %>% max()
?cut
cuts <- cut(subtimes_unix, breaks = "300 seconds", labels = FALSE)
cuts <- cut(as.POSIXct(subtimes_unix), breaks = "300 seconds", labels = FALSE)
cuts <- cut(as.POSIXct(subtimes_unix, origin = "1970-01-01"), breaks = "300 seconds", labels = FALSE)
sorted_submission_times
sorted_submission_times$subtime_datetime %>% cut(breaks = "2 hours", labels = FALSE)
sorted_submission_times$subtime_datetime %>% cut(breaks = "2 minutes", labels = FALSE)
60 / 5
1/12
sorted_submission_times$subtime_datetime %>% cut(breaks = "0.1 hours", labels = FALSE)
sorted_submission_times$subtime_datetime %>% cut(breaks = "5 min", labels = FALSE)
data.frame(sorted_submission_times$subtime_datetime,
cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
timeslices <- data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
timeslices %>%
group_by(bin) %>%
summarize(count = n())
timeslices %>%
group_by(bin) %>%
summarize(count = n()) -> arrival_counts
?cut
subtimes_unix <- sorted_submission_times$subtime_datetime %>% as.numeric()
cuts <- cut(subtimes_unix, breaks = 300, labels = FALSE)
timeslices <- data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
timeslices %>%
group_by(bin) %>%
summarize(count = n()) -> arrival_counts
arrival_counts %>%
aes(x = )
arrival_counts
arrival_counts %>%
aes(x = bin, y = count) +
geom_histogram(stat = "identity")
arrival_counts %>%
ggplot(aes(x = bin, y = count)) +
geom_histogram(stat = "identity")
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram()
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$bin %>% unique() %>% length())
arrival_counts$bin %>% unique() %>% length()
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram()
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = 50)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = 100)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = 1000)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = 10)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = 15)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length())
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length(), binwidth = 0.4)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length(), binwidth = 0.6)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length(), binwidth = 1)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length(), binwidth = 2)
arrival_counts %>%
ggplot(aes(x = count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length())
?cut
subtimes_unix <- sorted_submission_times$subtime_datetime %>% as.numeric()
cuts <- cut(subtimes_unix, breaks = 300, labels = FALSE)
timeslices <- data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
timeslices %>%
group_by(bin) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_histogram(bins = arrival_counts$count %>% unique() %>% length())
?cut
subtimes_unix <- sorted_submission_times$subtime_datetime %>% as.numeric()
cuts <- cut(subtimes_unix, breaks = 300, labels = FALSE)
timeslices <- data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
timeslices %>%
group_by(bin) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE)) %>%
group_by(bin) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
arrival_count
arrival_counts
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "5 min", labels = FALSE))
arrival_counts
arrival_counts$arr_count
arrival_counts$arr_count %>% mean()
arrival_counts
arrival_counts$arr_count %>% mean()
rpois(1193, 3.204526)
data.frame(V = rpois(1193, 3.204526))
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_histogram()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
arrival_counts %>%
ggplot(aes(x = arr_count)) +
# geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
geom_bar()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
arrival_counts %>%
ggplot(aes(x = arr_count)) +
# geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
geom_bar()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
arrival_counts %>%
ggplot(aes(x = arr_count)) +
# geom_histogram(bins = arrival_counts$arr_count %>% unique() %>% length())
geom_bar()
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
group_by(bin) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
arrival_counts$arr_count %>% mean()
data.frame(V = rpois(1193, 3.204526)) %>%
ggplot(aes(x = V)) +
geom_bar()
arrival_counts$arr_count %>% mean()
arrival_counts
arrival_counts$arr_count %>% mean()
data.frame(V = rpois(2800, 1.365357)) %>%
ggplot(aes(x = V)) +
geom_bar()
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
group_by(bin) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
arrival_counts$arr_count %>% mean()
data.frame(V = rpois(2800, 1.365357)) %>%
ggplot(aes(x = V)) +
geom_bar()
arrival_counts
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
group_by(bin, .drop = FALSE) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
arrival_counts
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE))
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = as.factor(bin))
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = as.factor(bin, levels = seq(1, max(bin), by = 1)))
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1)))
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1))) -> tmp
tmp$bin %>% levels()
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1))) %>%
group_by(bin, .drop = FALSE) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
arrival_counts$arr_count %>% mean()
arrival_counts
arrival_counts$arr_count %>% mean()
data.frame(V = rpois(6717, 0.5691529)) %>%
ggplot(aes(x = V)) +
geom_bar()
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1))) %>%
group_by(bin, .drop = FALSE) %>%
summarize(arr_count = n()) -> arrival_counts
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
arrival_counts$arr_count %>% mean()
data.frame(V = rpois(6717, 0.5691529)) %>%
ggplot(aes(x = V)) +
geom_bar()
data
data %>%
dplyr::group_by(samptime_datetime)
data %>%
dplyr::group_by(samptime_datetime) %>%
slice_max(30)
data$samptime_datetime[1]
data$samptime_datetime[1]$second
second(data$samptime_datetime[1])
lubridate::second(data$samptime_datetime[1])
data %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0))
dplyr::group_by(samptime_coarse) %>%
slice_max(30)
data %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(30)
data %>%
select(id, score, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(30)
data %>%
select(id, score, subtime_datetime, samptime_datetime)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(30)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(30) %>%
arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(30, order_by = subtime_datetime) %>%
arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
slice_max(n = 30, order_by = subtime_datetime) %>%
arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::mutate(rank_newpage = dplyr::row_number()) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse)
data %>%
dplyr::select(id, score, subtime_datetime, samptime_datetime) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::mutate(rank_newpage = dplyr::row_number()) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse) -> newpage_moving_window
newpage_moving_window
newpage_moving_window %>%
ggplot(aes(x = rank_newpage, y = score, group = id)) +
geom_line()
newpage_moving_window %>%
ggplot(aes(x = rank_newpage, y = score, group = id)) +
geom_line(alpha = 0.1)
`n'est pas`(c(FALSE, TRUE, FALSE))
data %>%
dplyr::select(id, score, rank, subtime_datetime, samptime_datetime) %>%
dplyr::rename(rank_toppage = rank)
data %>%
dplyr::select(id, score, rank, subtime_datetime, samptime_datetime) %>%
dplyr::rename(rank_toppage = rank) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::mutate(rank_newpage = dplyr::row_number()) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse) -> newpage_moving_window
newpage_moving_window %>%
ggplot(aes(x = rank_newpage, y = score, group = id)) +
geom_line(alpha = 0.1)
data %>%
dplyr::select(id, score, rank, subtime_datetime, samptime_datetime) %>%
dplyr::rename(rank_toppage = rank) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::mutate(rank_newpage = dplyr::row_number()) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse) %>%
dplyr::mutate(on_toppage = !is.na(rank)) -> newpage_moving_window
newpage_moving_window
data %>%
dplyr::select(id, score, rank, subtime_datetime, samptime_datetime) %>%
dplyr::rename(rank_toppage = rank) %>%
dplyr::mutate(samptime_coarse = update(samptime_datetime, second = 0)) %>%
dplyr::group_by(samptime_coarse) %>%
dplyr::slice_max(n = 30, order_by = subtime_datetime) %>%
dplyr::mutate(rank_newpage = dplyr::row_number()) %>%
dplyr::ungroup() %>%
dplyr::arrange(samptime_coarse) %>%
dplyr::mutate(on_toppage = !is.na(rank_toppage)) -> newpage_moving_window
newpage_moving_window
newpage_moving_window %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_line(alpha = 0.1)
newpage_moving_window %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_line(alpha = 0.8)
newpage_moving_window %>%
get_random_sample(30) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_line(alpha = 0.8)
newpage_moving_window %>%
get_random_sample(n = 30) %>%
ggplot(aes(x = rank_newpage, y = score, group = id, color = on_toppage)) +
geom_line(alpha = 0.8)
newpage_moving_window %>%
get_random_sample(n = 30)
newpage_moving_window
get_random_sample(data = newpage_moving_window, n = 30)
data %>%
dplyr::select(id) %>%
unique() %>%
cbind(anon_id = seq(1, dim(id_set)[1], by = 1)) -> id_set
data %>%
dplyr::select(id) %>%
unique() %>%
cbind(anon_id = seq(1, dim(id_set)[1], by = 1)) -> id_set
id_set
id_set
data %>%
dplyr::select(id) %>%
unique() %>%
arrange(id) %>%
cbind(anon_id = seq(1, dim(id_set)[1], by = 1)) -> id_set
id_set
# compute for every 1 minute timeslice how many new stories are posted
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1))) %>%
group_by(bin, .drop = FALSE) %>%
summarize(arr_count = n()) -> arrival_counts
# show real distribution of arrival times
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar()
# show simulated distribution of arrival times
data.frame(V = rpois(6717, mean(arrival_counts$arr_count))) %>%
ggplot(aes(x = V)) +
geom_bar()
# show real distribution of arrival times
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar() +
ylim(4000)
# show real distribution of arrival times
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar() +
ylim(c(0, 4000))
# compute for every 1 minute timeslice how many new stories are posted
data.frame(subtime = sorted_submission_times$subtime_datetime,
bin = cut(sorted_submission_times$subtime_datetime, breaks = "1 min", labels = FALSE)) %>%
mutate(bin = factor(bin, levels = seq(1, max(bin), by = 1))) %>%
group_by(bin, .drop = FALSE) %>%
summarize(arr_count = n()) -> arrival_counts
# show real distribution of arrival times
arrival_counts %>%
ggplot(aes(x = arr_count)) +
geom_bar() +
ylim(c(0, 4000))
# show simulated distribution of arrival times
data.frame(V = rpois(6717, mean(arrival_counts$arr_count))) %>%
ggplot(aes(x = V)) +
geom_bar() +
ylim(c(0, 4000))
